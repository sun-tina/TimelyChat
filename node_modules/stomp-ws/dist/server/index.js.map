{"version":3,"file":"index.js","sources":["../../../src/common/frame.ts","../../../src/server/index.ts"],"sourcesContent":[null,null],"names":["MalformedFrameError","Error","constructor","message","Object","setPrototypeOf","prototype","textDecoder","TextDecoder","textEncoder","TextEncoder","escape","str","replace","unescape","encode","frame","command","headers","body","key","hasOwnProperty","call","length","s","combined","Uint8Array","set","decode","bytes","buffer","cursor","getLine","index","slice","line","headerLine","msg","parts","split","value","verifyHeader","required","optional","h","undefined","extra","keys","join","noBody","verifyClient","heartBeat","test","ack","includes","toClientFrame","data","decoded","Server","options","send","session","socket","_getSocket","listen","arg0","arg1","Promise","resolve","reject","_sessionListeners","push","_listeners","close","_sockets","ws","status","cx","parseInt","cy","sx","serverHeartBeat","sy","clientHeartBeat","Math","max","interval","setInterval","Date","now","lastSend","origSend","args","apply","addEventListener","clearInterval","lastRecv","start","wss","WebSocket","server","path","on","terminate","setTimeout","onmessage","clearTimeout","off","getSession","then","version","list","obj","fn","indexOf","splice","processed","catch","err","listeners","onClose","stop"],"mappings":"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"}